{
	"AWSTemplateFormatVersion":"2010-09-09",
	"Description":"02 - creates acls",
	"Parameters":{
		"env":{
			"Type":"String"
		},
		"vpc":{
			"Type":"String"
		},
		"webSubnet":{
			"Type":"String",
			"Description":"::webSubnet"
		},
		"dbSubnet":{
			"Type":"String",
			"Description":"::dbSubnet"
		}	
	},
	"Resources":{
		"assocAclWebSubnet":{
			"Type":"AWS::EC2::SubnetNetworkAclAssociation",
			"Properties":{
				"SubnetId":{
					"Ref":"webSubnet"
				},
				"NetworkAclId":{
					"Ref":"webAcl"
				}			
			}
		},
		"assocAclDbSubnet":{
			"Type":"AWS::EC2::SubnetNetworkAclAssociation",
			"Properties":{
				"SubnetId":{
					"Ref":"dbSubnet"
				},
				"NetworkAclId":{
					"Ref":"dbAcl"
				}			
			}
		},
		"webAcl":{
			"Type":"AWS::EC2::NetworkAcl",
			"Properties":{
				"VpcId":{
					"Ref":"vpc"
				}			
			}
		},
		"dbAcl":{
			"Type":"AWS::EC2::NetworkAcl",
			"Properties":{
				"VpcId":{
					"Ref":"vpc"
				}			
			}
		},
		"networkAclEntryWebE100":{
			"Type":"AWS::EC2::NetworkAclEntry",
			"Properties":{
				"NetworkAclId":{
					"Ref":"webAcl"
				},
				"RuleNumber":"100",
				"RuleAction":"allow",
				"Egress":"true",
				"CidrBlock":"0.0.0.0/0",
				"Protocol":"6",
				"PortRange":{
					"From":"1024",
					"To":"65535"
				}			
			}
		},
		"dbRouteTable" : { 
            "Type" : "AWS::EC2::RouteTable",
            "Properties" : {
                "VpcId" :  { "Ref" : "vpc" }
           }
        }
	}
}